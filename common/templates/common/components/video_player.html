<link href="https://vjs.zencdn.net/8.0.4/video-js.css" rel="stylesheet" />
<script defer src="https://vjs.zencdn.net/8.0.4/video.min.js"></script>

<video
  id="{{ vid }}"
  class="video-js"
  controls
  preload="auto"
  {% if poster %}poster="{{ poster }}"{% endif %} 
  data-setup="{}"
  style="position: relative;
  width: 100%;
  height: auto;
  overflow: hidden;
  border-radius: .33rem;"
>
  
  {% if m3u8URL %}
    {% for m3u8 in m3u8URL|dictsortreversed:"id"|slice:":1" %}
      {% if m3u8.types == "playlist" %}
        <source src="{{ m3u8.source.url }}" type="application/x-mpegURL"/>
      {% endif %}
    {% endfor %}
  {% else %}
    <source src="{{ url }}" type="{{ videoType }}"/>
  {% endif %}  

  {% for track in tracks %}
    <track kind="captions" label="{{ track.get_language_display }}" src="{{ track.url }}" srclang="{{ track.language }}" {% if track.language == "zh-hans" %}default{% endif %}/>
  {% endfor %}

</video>
