{% extends 'films/gallery.html' %}
{% load film_extras %}
{% load common_extras %}

{% block title_append %} - {{ film.title }} {{ current_collection.name }}{% endblock title_append %}

{% block gallery_files %}

<div>

  <p>{% with_shortcodes current_collection.text|markdown %}</p>
  <div class="">
    <div class="files row grid">
      <div class="grid-sizer col-12 col-sm-6 col-md-6 col-lg-4"></div>
      {% if child_collections %}
      {% for child_collection in child_collections %}
      {% include "common/components/folder.html" %}
      {% endfor %}
      {% endif %}

      {% if current_assets %}
      {% for asset in current_assets %}
      {% if asset.is_published or request.user.is_superuser %}
      {% include "common/components/file.html" with asset=asset site_context="gallery" aspect_ratio=current_collection.thumbnail_aspect_ratio %}
      {% endif %}
      {% endfor %}
      {% endif %}

    </div>
  </div>

</div>

{% endblock gallery_files %}

{% block scripts_footer %}

<script>
  var $grid = $('.grid').masonry({
    itemSelector: '.grid-item',
    columnWidth: '.grid-sizer',
    percentPosition: true,
    horizontalOrder: true,
  });

  $grid.imagesLoaded().progress(function () {
    $grid.masonry('layout');
  });

</script>

{% endblock scripts_footer %}
