{% macro breadcrumbs() %}
    <ol class="breadcrumb">
        {{ caller() }}
    </ol>
{% endmacro %}

{% macro breadcrumb(label, url=None) %}
    <li class="breadcrumb-item">
        {% if url is not none %}
            <a href="{{ url }}">{{ label }}</a>
        {% else %}
            {{ label }}
        {% endif %}
    </li>
{% endmacro %}

{% macro cards() %}
    <div class="row">
        {{ caller() }}
    </div>
{% endmacro %}

{% macro pills(class=[]) %}
    <div class="pills {{ class|join(' ') }}">
        {{ caller() }}
    </div>
{% endmacro %}

{% macro pill(label, url=None, color='blue') %}
    {% if url is none %}
        <p class="badge badge-pill badge-{{ color }}">{{ label }}</p>
    {% else %}
        <a class="badge badge-pill badge-{{ color }}" href="{{ url }}">{{ label }}</a>
    {% endif %}
{% endmacro %}

{% macro checkbox_favorite(checked, class=[]) %}
    {% if checked %}
        <button class="btn btn-primary btn-ctrl-sm {{ class|join(' ') }}">
            <i class="material-icons btn-material-icons">add</i>
        </button>
    {% else %}
        <button class="btn btn-secondary btn-ctrl-sm {{ class|join(' ') }}">
            <i class="material-icons btn-material-icons">check</i>
        </button>
    {% endif %}
{% endmacro %}

{% macro checkbox_toggle(checked) %}
    <div class="col-md-auto text-right">
        <div class="form-group">
            <label class="form-group form-switch">
                {% if checked %}
                    <input type="checkbox" class="form-check-input" checked="checked">
                {% else %}
                    <input type="checkbox" class="form-check-input">
                {% endif %}
                <span class="slider"></span>
            </label>
        </div>
    </div>
{% endmacro %}

{% macro progressbar(fraction) %}
    <div class="progress">
        <div class="progress-bar" role="progressbar" style="width:{{ fraction*100 }}%;"></div>
    </div>
{% endmacro %}

{% macro badge_difficulty(label, color='blue') %}
    <div class="badge badge-difficulty badge-{{ color }}">
        <i class="material-icons btn-material-icons">extension</i>
        {{ label }}
    </div>
{% endmacro %}

{% macro card_training(training) %}
    {% set difficulty_color = {'beginner': 'green', 'intermediate': 'blue', 'advanced': 'red'}.get(training.difficulty, 'blue') %}
    {% set image_placeholder = static('training_main/images/placeholders/card_training.png') %}
    <div class="col-12 col-sm-6 col-lg-4">
        <div class="card card-media">

            <div class="card-header" style='background-image: url("{{ image_placeholder }}")'>
                {{ badge_difficulty(label=training.difficulty.label, color=difficulty_color) }}
                {{ checkbox_favorite(checked=False, class=['btn-save-media']) }}
                {{ progressbar(1/4) }}
            </div>

            <a class="card-body" href="{{ training.url }}">
                <p class="card-subtitle">{{ training.type.label }}</p>
                <h2 class="card-title">{{ training.name }}</h2>
                <p class="card-text">{{ training.description }}</p>
            </a>

            <div class="card-footer">
                {% call pills() %}
                    {% for tag in training.tags %}
                        {{ pill(label=tag) }}
                    {% endfor %}
                {% endcall %}
            </div>

        </div>
    </div>
{% endmacro %}

{% macro jumbotron() %}
    {% set image_placeholder = static('training_main/images/placeholders/jumbotron.png') %}
    <div style="background-image:url('{{ image_placeholder }}')"
         class="jumbotron jumbotron-fluid jumbotron-overlay header">
        <div class="container">
            <div class="row">
                <div class="col-lg-5 col-xl-4">
                    <div class="jumbotron-body">
                        {{ caller() }}
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endmacro %}

{% macro searchbar(placeholder) %}
    <div class="input-group">
        <div class="input-group-prepend"><span class="input-group-text"><i class="material-icons">search</i></span>
        </div>
        <input type="text" placeholder="{{ placeholder }}" class="form-control">
    </div>
{% endmacro %}

{% macro select() %}
    <select class="custom-select">
        {{ caller() }}
    </select>
{% endmacro %}

{% macro video_player(url) %}
    <video id="player" playsinline controls>
        <source src="{{ url }}">
    </video>
{% endmacro %}

{% macro comments(comment_trees) %}
    <h3 class="mb-2">12 Comments</h3>
    <div class="row my-2">
        <div style="background-image:url('https://blender.chat/avatar/MikeNewbon');" class="profile"></div>
        <div class="col">
            <div class="input-group input-group-sm">
                <input type="text" placeholder="Comment publicly" class="form-control">
                <div class="input-group-append">
                    <button class="btn btn-input">Comment</button>
                </div>
            </div>
        </div>
    </div>
    {{ _comment_trees(comment_trees) }}
{% endmacro %}

{% macro _comment_trees(comment_trees) %}
    {% for comment in comment_trees %}
        <div class="row comment">
            <div class="col-md-12">
                <div class="row comment-header">
                    <div style="background-image:url('https://blender.chat/avatar/MikeNewbon');" class="profile"></div>
                    <div class="col-md-auto">
                        <h4 class="comment-name">{{ comment.username }}</h4>
                        <p class="comment-date">{{ comment.date_updated.strftime('%d %B %Y - %H:%M') }}</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <p class="comment-text">{{ comment.message }}</p>
                        <div class="comment-likes">
                            <i class="material-icons comment-likes-btn">favorite_border</i>
                            <p class="comment-likes-count">{{ comment.likes }}</p>
                            <a href="#" class="comment-reply">Reply</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                {{ _comment_trees(comment.replies) }}
            </div>
        </div>
    {% endfor %}
{% endmacro %}
